<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="fi"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>UserFormGUI.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JaCoCoverage analysis of project &quot;Ohjelmistotuotantoprojekti1&quot; (powered by JaCoCo from EclEmma)</a> &gt; <a href="index.source.html" class="el_package">gui</a> &gt; <span class="el_source">UserFormGUI.java</span></div><h1>UserFormGUI.java</h1><pre class="source lang-java linenums">/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package gui;

import java.io.IOException;
import java.time.LocalDate;
import java.time.ZoneId;
import java.util.Date;
import javafx.beans.value.ChangeListener;
import javafx.beans.value.ObservableValue;
import javafx.collections.FXCollections;
import javafx.collections.ObservableList;
import javafx.fxml.FXML;
import javafx.fxml.FXMLLoader;
import javafx.scene.control.*;
import javafx.scene.layout.*;
import javafx.scene.text.Text;
import javafx.stage.StageStyle;
import model.User_IF;
import model.Employee;

/**
 *
 * @author Paula
 */
public class UserFormGUI extends Tab implements UserFormGUI_IF  {
    
    @FXML
    private GridPane gridPane;
    @FXML
    private Label employeeLabel;
    @FXML
    private Text employeeField;
    @FXML
    private Label userIDLabel;
    @FXML
    private Text userIDField;
    @FXML
    private Label emailLabel ;
    @FXML
    private Text emailField;
    @FXML
    private Label usernameLabel;
    @FXML
    private TextArea usernameField;
    @FXML
    private Label passwordLabel;
    @FXML
    private TextArea passwordField;
    @FXML
    private ButtonBar buttonBar;
    @FXML
    private Button cancelButton;
    @FXML
    private Button saveButton;
    

    private final SideBarListView_IF&lt;Employee&gt; employeeSelector;
    private User_IF user;
    private FXMLLoader loader;
    
    private int id;
    private Employee employee;
    private String username;
    private String password;
    private String email;
       
<span class="nc" id="L71">    public UserFormGUI(SideBarListView_IF&lt;Employee&gt; employeeSelector, User_IF user) {</span>
<span class="nc" id="L72">        this.employeeSelector = employeeSelector;</span>
<span class="nc" id="L73">        this.user = user;</span>
<span class="nc" id="L74">        this.id = this.user.getUserID();        </span>
<span class="nc" id="L75">        this.employee = employee;</span>
<span class="nc" id="L76">        this.username = user.getUsername();</span>
<span class="nc" id="L77">        this.password = user.getPassword();</span>
<span class="nc" id="L78">        this.email = user.getEmail();        </span>
        try {
<span class="nc" id="L80">            loader = new FXMLLoader(getClass().getResource(&quot;UserForm.fxml&quot;));</span>
<span class="nc" id="L81">            loader.setController(this);</span>
<span class="nc" id="L82">            loader.setRoot(this);</span>
<span class="nc" id="L83">            loader.load();</span>
          //this.initializeFields(); Mahdolliset update operaatiot!!
<span class="nc" id="L85">            this.initializeBasicListeners();</span>
<span class="nc bnc" id="L86" title="All 2 branches missed.">            if (this.employee == null) {</span>
<span class="nc" id="L87">                this.initializeNewUserListeners(); </span>
            } 
<span class="nc" id="L89">        } catch (IOException ex) {</span>
<span class="nc" id="L90">            ex.printStackTrace();</span>
<span class="nc" id="L91">        }</span>
<span class="nc" id="L92">    }</span>
    
    private void initializeFields() {
       // this.setText(title);
        
<span class="nc bnc" id="L97" title="All 2 branches missed.">        if (this.id != 0) {</span>
<span class="nc" id="L98">            this.userIDLabel.setText(&quot;#&quot; + Integer.toString(this.id));</span>
        }                
<span class="nc bnc" id="L100" title="All 2 branches missed.">        if (this.employee != null) {</span>
<span class="nc" id="L101">            this.employeeField.setText(this.employee.toString());</span>
        }
              
<span class="nc" id="L104">        this.usernameField.setText(this.username);</span>
<span class="nc" id="L105">        this.passwordField.setText(this.password);</span>
<span class="nc" id="L106">        this.emailField.setText(this.email);</span>
<span class="nc" id="L107">      }</span>
    
    private void initializeBasicListeners() {
  
<span class="nc" id="L111">        this.usernameField.setOnKeyReleased(e -&gt; {</span>
<span class="nc" id="L112">            this.username= this.usernameField.getText();</span>
<span class="nc" id="L113">            this.user.setUsername(this.username);</span>
<span class="nc" id="L114">        });</span>
        
<span class="nc" id="L116">        this.passwordField.setOnKeyReleased(e -&gt; {</span>
<span class="nc" id="L117">            this.password= this.passwordField.getText();</span>
<span class="nc" id="L118">            this.user.setPassword(this.password);</span>
<span class="nc" id="L119">        });</span>
<span class="nc" id="L120">    }</span>
     
    private void initializeNewUserListeners() {
<span class="nc" id="L123">        this.employeeSelector.getListView().getSelectionModel().selectedItemProperty().addListener(new ChangeListener&lt;Employee&gt;() {</span>
            @Override
            public void changed(ObservableValue&lt;? extends Employee&gt; ov, Employee oldValue, Employee newValue) {
<span class="nc bnc" id="L126" title="All 2 branches missed.">                if (newValue != null) {</span>
<span class="nc" id="L127">                    employee = newValue;</span>
<span class="nc" id="L128">                    user.setFirstName(employee.getFirstName());</span>
<span class="nc" id="L129">                    user.setLastName(employee.getLastName());</span>
<span class="nc" id="L130">                    user.setEmail(employee.getEmail());</span>
<span class="nc" id="L131">                    user.setUserID(employee.getUserID());</span>
<span class="nc bnc" id="L132" title="All 2 branches missed.">                    if (employee.getTitle().equals(&quot;Hoitaja&quot;)){</span>
<span class="nc" id="L133">                        user.setUsertype(1);</span>
<span class="nc bnc" id="L134" title="All 2 branches missed.">                    }else if (employee.getTitle().equals(&quot;Lääkäri&quot;)){</span>
<span class="nc" id="L135">                        user.setUsertype(2);</span>
<span class="nc bnc" id="L136" title="All 2 branches missed.">                    }else if (employee.getTitle().equals(&quot;Admin&quot;)){</span>
<span class="nc" id="L137">                        user.setUsertype(3);</span>
                    } else {
<span class="nc" id="L139">                        user.setUsertype(0);}</span>
                    
<span class="nc" id="L141">                    employeeField.setText(employee.getFirstName() + &quot; &quot; + employee.getLastName());</span>
<span class="nc" id="L142">                    userIDField.setText(Integer.toString(employee.getUserID()));</span>
<span class="nc" id="L143">                    emailField.setText(employee.getEmail());                    </span>
                }
              
<span class="nc" id="L146">            }</span>
        }
<span class="nc" id="L148">        ); }</span>
   
    
    @Override
    public Employee getEmployee() {
<span class="nc" id="L153">        return this.employee;</span>
    }
    
    @Override
    public Text getEmployeeField() {
<span class="nc" id="L158">        return this.employeeField;    </span>
    }

    @Override
    public Button getCancelButton() {
<span class="nc" id="L163">        return cancelButton;</span>
    }

    @Override
    public Button getSaveButton() {
<span class="nc" id="L168">        return saveButton;</span>
    }
    
    @Override
    public User_IF getUser() {
<span class="nc" id="L173">        return this.user;</span>
    }
    
    


}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>